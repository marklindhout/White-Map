/*! whitemap 2015-01-26 */

var WhiteMap=WhiteMap||{};WhiteMap.center=new L.LatLng(WhiteMap.map_default_location.latitude,WhiteMap.map_default_location.longitude),null!==document.getElementById("wmap")&&(WhiteMap.map=L.map("wmap",{center:WhiteMap.center,zoom:15})),WhiteMap.map_popup=L.Popup.extend({options:{minWidth:320,maxHeight:256,closeButton:!0,offset:[128,128],autoPanPaddingTopLeft:new L.Point(32,0),autoPanPaddingBottomRight:new L.Point(0,300),className:"wmap_popup"}}),WhiteMap.map_layer=L.tileLayer(WhiteMap.map_layer.url,{attribution:WhiteMap.map_layer.attribution,opacity:WhiteMap.map_layer.opacity}),WhiteMap.center_marker_icon=new L.divIcon({iconSize:[16,16],className:"center_marker_icon",html:'<div class="pulsar"></div><div class="inner"></div>'}),WhiteMap.marker_normal=L.Icon.extend({options:{iconUrl:WhiteMap.map_marker_normal.url,iconSize:[WhiteMap.map_marker_normal.width,WhiteMap.map_marker_normal.height],iconAnchor:[parseInt(WhiteMap.map_marker_normal.width/2,10),WhiteMap.map_marker_normal.height]}}),WhiteMap.marker_active=L.Icon.extend({options:{iconUrl:WhiteMap.map_marker_active.url,iconSize:[WhiteMap.map_marker_active.width,WhiteMap.map_marker_active.height],iconAnchor:[parseInt(WhiteMap.map_marker_active.width/2,10),WhiteMap.map_marker_active.height]}}),WhiteMap.all_markers=[],WhiteMap.add_markers=function(){for(var a=WhiteMap.locations,b=0;b<a.length;b++){var c=!1,d="",e=new WhiteMap.map_popup,f=!1;if(a[b].hasOwnProperty("title")&&(d+='<h2 class="title">',d+='<a href="'+a[b].permalink+'">',d+=a[b].title,d+="</a>\n",d+="</h2>\n"),(a[b].hasOwnProperty("street")||a[b].hasOwnProperty("postal")||a[b].hasOwnProperty("city"))&&(d+='<div class="address">',a[b].hasOwnProperty("street")&&a[b].street&&(d+=a[b].street+'<span class="divider"> </span>'),a[b].hasOwnProperty("postal")&&a[b].postal&&(d+=a[b].postal+'<span class="divider"> </span>'),a[b].hasOwnProperty("city")&&a[b].city&&(d+=a[b].city),d+="</div>\n"),a[b].hasOwnProperty("description")){var g=!1;a[b].hasOwnProperty("desc_is_cut")&&(g=a[b].desc_is_cut?" cut":""),d+='<div class="description'+g+'">'+a[b].description+"</div>\n"}if(a[b].hasOwnProperty("tags")){d+='<ul class="tags">';for(var h=0;h<a[b].tags.length;h++)d+='<li class="tag">',d+=a[b].tags[h],d+="</li>";d+="</ul>\n"}a[b].hasOwnProperty("latitude")&&(f=a[b].latitude),a[b].hasOwnProperty("longitude")&&(lng=a[b].longitude),(f||lng)&&(c=L.marker([f,lng],{icon:new WhiteMap.marker_normal})),e.setContent(d),c.bindPopup(e),c.addTo(WhiteMap.map),WhiteMap.all_markers.push(c)}WhiteMap.markers_event_handlers(),WhiteMap.reset_all_markers(),WhiteMap.map.addEventListener("click",function(){WhiteMap.reset_all_markers()})},WhiteMap.get_geolocation=function(){WhiteMap.map.locate({setView:!0}),WhiteMap.map.on("locationfound",WhiteMap.map_handle_locationfound),WhiteMap.map.on("locationerror",WhiteMap.map_handle_locationerror)},WhiteMap.map_handle_locationfound=function(a){WhiteMap.set_geolocation_marker(a.latlng)},WhiteMap.map_handle_locationerror=function(){console.error("No geolocation found!")},WhiteMap.set_geolocation_marker=function(a){var b=L.marker(a,{icon:WhiteMap.center_marker_icon});b.addTo(WhiteMap.map).setZIndexOffset(1e3)},WhiteMap.reset_all_markers=function(){for(var a=0;a<WhiteMap.all_markers.length;a++){var b=WhiteMap.all_markers[a];b.setIcon(new WhiteMap.marker_normal)}},WhiteMap.markers_event_handlers=function(){for(var a=0;a<WhiteMap.all_markers.length;a++){var b=WhiteMap.all_markers[a];b.addEventListener("click",function(){WhiteMap.reset_all_markers(),this.setIcon(new WhiteMap.marker_active)})}},WhiteMap.setup_map=function(){WhiteMap.map_layer.addTo(WhiteMap.map)},WhiteMap.init_home=function(){WhiteMap.setup_map(),WhiteMap.get_geolocation(),WhiteMap.add_markers()},WhiteMap.init_single_location=function(){WhiteMap.setup_map();var a=L.marker(WhiteMap.center,{icon:new WhiteMap.marker_normal});a.addTo(WhiteMap.map),WhiteMap.map.setView(WhiteMap.center),WhiteMap.map.dragging.disable(),WhiteMap.map.doubleClickZoom.disable(),WhiteMap.map.scrollWheelZoom.disable(),WhiteMap.map.boxZoom.disable(),WhiteMap.map.keyboard.disable(),WhiteMap.map.removeControl(WhiteMap.map.zoomControl)},$(document).ready(function(){$("body").hasClass("home")?WhiteMap.init_home():$("body").hasClass("single-location")&&WhiteMap.init_single_location()});var reset_rating=function(a){a.find(".stars .star").removeClass("checked"),set_rating_state(a)},set_rating_state=function(a){var b=a.find(".star"),c=a.find(".star.checked").length>0,d=0;if(b.removeClass("active"),c){for(var e=a.find(".star.checked").last().index()+1,f=0;e>f;f++)a.find(".star:eq("+f+")").addClass("active");d=e}a.find('input[name="rating"]').val(d)};!function(a){"use strict";a(".rating-execute").each(function(){var b=a(this);a(this).find(".reset_rating").on("click",function(a){a.preventDefault(),reset_rating(b)}),a(this).find(".stars .star").on("click",function(){a(this).siblings(".star").removeClass("checked"),a(this).addClass("checked"),set_rating_state(b)}),set_rating_state(b)})}(jQuery),$(document).ready(function(){var a=$("#menutoggle .button"),b=$("#container"),c="menu_shown";a.click(function(a){a.preventDefault(),b.hasClass(c)?b.removeClass(c):b.addClass(c)})});
//# sourceMappingURL=whitemap.min.js.map