/*! white-map 2014-12-19 */
var WhiteMap=WhiteMap||{};WhiteMap.wmap_popup=L.Popup.extend({options:{minWidth:320,maxHeight:256,closeButton:!0,offset:[128,128],autoPanPaddingBottomRight:new L.Point(0,300),className:"wmap_popup"}}),WhiteMap.mm_load=function(a,b){posts=a.posts;for(var c=0;c<posts.length;c++){var d=!1,e="",f=new WhiteMap.wmap_popup,g=!1;posts[c].hasOwnProperty("title")&&(e+='<h2 class="title">',e+='<a href="'+posts[c].permalink+'">',e+=posts[c].title,e+="</a>\n",e+="</h2>\n"),(posts[c].hasOwnProperty("street")||posts[c].hasOwnProperty("postal")||posts[c].hasOwnProperty("city"))&&(e+='<div class="address">',posts[c].hasOwnProperty("street")&&posts[c].street&&(e+=posts[c].street+'<span class="divider"> </span>'),posts[c].hasOwnProperty("postal")&&posts[c].postal&&(e+=posts[c].postal+'<span class="divider"> </span>'),posts[c].hasOwnProperty("city")&&posts[c].city&&(e+=posts[c].city),e+="</div>\n"),posts[c].hasOwnProperty("description")&&(e+='<div class="description">'+posts[c].description+"</div>\n"),posts[c].hasOwnProperty("latitude")&&(g=posts[c].latitude),posts[c].hasOwnProperty("longitude")&&(lng=posts[c].longitude),(g||lng)&&(d=L.marker([g,lng],{icon:new WhiteMap.wmap_icon_0})),f.setContent(e),d.bindPopup(f),d.addTo(b)}},WhiteMap.get_location=function(){if(!navigator.geolocation)throw new Error("Geolocation not supported by this browser.");navigator.geolocation.getCurrentPosition(function(a){var b=new L.LatLng(a.coords.latitude,a.coords.longitude);WhiteMap.set_map_to(b,WhiteMap.wmap)},function(){throw new Error("Geolocation error.")})},WhiteMap.set_map_to=function(a,b){if(!b)throw new Error("No map specified");b.panTo(a)},$(document).ready(function(){0!==$("#map-container").length&&WhiteMap.get_location()}),$(document).ready(function(){if(0!==$("#map-container").length){var a=$.parseJSON(whitemap.locations);WhiteMap.mm_load(a,WhiteMap.wmap),WhiteMap.get_location()}}),$(document).ready(function(){var a=$("#menutoggle .button"),b=$("#container"),c="menu_shown";a.click(function(a){a.preventDefault(),b.hasClass(c)?b.removeClass(c):b.addClass(c)})});